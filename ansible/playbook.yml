---
- hosts: all
  sudo: true
  tasks:
    - copy: src=sources.list dest=/etc/apt/sources.list
      
    # Run the equivalent of "apt-get update" as a separate step
    - apt: update_cache=yes


    # Update all packages to the latest version
    - apt: upgrade=dist


    - name: apt-get install
      apt: name={{ item }}
      with_items:
        - default-jdk
        - htop
        - git
        - gcc
        - gdb
        - clang-3.6
        - lldb-3.6
        - silversearcher-ag
        - tshark


    # python
    - apt: name=python-dev
    - apt: name=python-pip
    - file: path=/root/.pip state=directory
    - copy: src=pip.conf dest=/root/.pip/pip.conf
    - pip: name=virtualenv
    - file: path=/home/vagrant/.pip state=directory
    - copy: src=pip.conf dest=/home/vagrant/.pip/pip.conf

    # postgresql dev
    - apt: name=libpq-dev
    - apt: name=libgeos-dev

    # lxml
    - apt: name=libxml2-dev
    - apt: name=libxslt-dev
    - pip: name=lxml virtualenv=/home/vagrant/virtualenv version=3.3.5
      sudo: false

    - pip: name={{ item }} virtualenv=/home/vagrant/virtualenv
      sudo: false
      with_items:
        - ipython
        - httpie
        - pymysql
        - sqlalchemy
        - pytest
        - pylint
        - psycopg2
        - lxml

    # lib dev
    - apt: name=libmysqlclient-dev
    - apt: name=libgit2-dev


    # golang
    - copy: src=go1.5.linux-amd64.tar.gz dest=/home/vagrant/go1.5.linux-amd64.tar.gz
      sudo: false
    - shell: tar xvf go1.5.linux-amd64.tar.gz
      sudo: false
    - file: path=/home/vagrant/work  owner=vagrant group=vagrant state=directory 

    # twemproxy
    - apt: name=libtool


      
    # gui
    # - apt: name=ubuntu-desktop
    # - apt: name=gnome-terminal
      
    # eclipse-cdt
    # - apt: name=eclipse-cdt


    # mysql
    - apt: name=mysql-server
    - copy: src=my.cnf dest=/etc/mysql/my.cnf
    - service: name=mysql state=restarted

    # redis
    - apt: name=redis-server


    # emacs
    - apt: name=postfix
    - command: apt-get build-dep -y emacs24
    - copy: src=emacs-24.5.tar.xz dest=/home/vagrant/emacs-24.5.tar.xz
    - shell: tar xvf emacs-24.5.tar.xz && cd emacs-24.5 && ./configure --prefix=/opt/app/emacs && make install

    # zsh
    - apt: name=zsh
    - user: name=vagrant shell=/bin/zsh
    - copy: src=.zshrc dest=/home/vagrant/.zshrc

    # tmux
    - copy: src=.tmux.conf dest=/home/vagrant/.tmux.conf

    # dev_vagrant_zeus
    - apt: name=python-mysqldb
    - mysql_db: name=dev_vagrant_zeus
    - mysql_user: name=eleme password=eleme priv=*.*:ALL

    #
    - mysql_db: name=ming
    - mysql_user: name=ming password=ming priv=*.*:ALL
